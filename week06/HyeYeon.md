# 6장 프락시

- 웹 프락시 서버는 중개자로, 클라이언트와 서버 사이에 위치하여 HTTP 메시지를 정리하는 중개인처럼 종작함.

## 6.1 웹 중개자

- 웹 프락시 서버는 클라이언트의 입장에서 트랜잭션을 수행하는 중개인
- HTTP 프락시 서버는 웹 서버이면서 웹 클라이언트이므로 HTTP 클라이언트/서버의 양쪽 규칙을 모두 따라야 함.

### 6.1.1 개인 프락시와 공유 프락시

- 공용 프락시: 여러 클라이언트가 함께 사용하는 공용 프락시로, 대부분의 프락시가 공용 프락시임.
- 개인 프락시: 하나의 클라이언트만을 위한 프락시

### 6.1.2 프락시 대 게이ㅡ웨이

- 프락시: 같은 프로토콜을 사용하는 둘 이상의 애플리케이션을 연결
- 게이트웨이: 서로 다른 프로토콜을 사용하는 둘 이상을 연결

## 6.2 왜 프락시를 사용하는가?

- 프락시를 사용함으로써 보안 개선, 성능 향상, 비용 절감 등의 효과를 얻을 수 있음.
- 어린이 필터, 문서 접근 제어자, 보안 방화벽, 웹 캐시, 대리 프락시, 콘텐츠 라우터, 트랜스코더, 익명호 프락시 등의 역할이 있음.

## 6.3 프락시는 어디에 있는가?

### 6.3.1 프락시 서버 배치

- 출구 프락시: 로컬 네트워크의 출구에서 방화벽을 제공하거나 인터넷 요금을 절약, 트래픽 성능 개선, 필터링 등을 담당함.
- 접근 프락시: ISP 접근 지점에 위치하여 사용자의 다운로드 속도를 개선하거나 캐시 프락시를 이용해 인터넷 대역폭 비용 절약 등의 역할을 담당함.
- 대리 프락시: 웹 서버의 바로 앞에 위치하여 보안 기능을 추가하거나 웹 서버 캐시를 놓아 성능 개선 등의 역할을 담당함. 일반적으로 웹 서버의 이름과 IP 주소로 스스로를 가장함.
- 네트워크 교환 프락시: 네트워크 사이 인터넷 피어링 교환 지점에서 캐시를 이용해 혼잡을 완화하거나 트래픽 흐름을 감시하는 역할을 담당함.

### 6.3.2 프락시 계층

- 프락시 계층에서 프락시 서버들은 부모와 자식의 관계를 가짐.
- 서버에 가까운 쪽이 부모 프락시, 클라이언트에 가까운 쪽이 자식 프락시
- 부하 균형, 지리적 인접성에 근거한 라우팅, 프로토콜/타입 라우팅, 유료 서비스 가입자를 위한 라우팅 등을 위해 동적으로 프락시 부모를 선택할 수 있음.

### 6.3.3 어떻게 프락시가 트래픽을 처리하는가

-클라이언트 트래픽이 프락시로 가도록 만드는 방법 - 브라우저에서 클라이언트의 요청을 수정하기 - 인터셉트 프락시에서 네트워크 인프라를 가로채기 - 대리 프락시에서 DNS 이름 공간을 수정하기 - HTTP 리다이렉션(305) 명령을 클라이언트에 돌려줌으로써 클라이언트의 요청을 프락시로 리다이렉트하도록 설정하기

## 6.4 클라이언트 프락시 설정

- 브라우저에서 프락시를 사용할 수 있도록 설정하는 방법
  - 수동 설정
  - 브라우저 기본 설정
  - 프락시 자동 설정(PAC)
  - WPAD 프락시 발견

## 6.5 프락시 요청의 미묘한 특징들

### 6.5.1 프락시 URI는 서버 URI와 다르다

- 클라이언트가 단일 서버에 요청을 보낼 때는 불필요한 정보 발송을 피하기 위해 스킴과 호스트를 생략한 부분 URI만 전송함. 즉, 클라이언트가 프락시를 사용하지 않도록 설정되어 있다면 부분 URI를 보냄.
- 프락시는 목적지 서버와 커넥션을 맺고 FTP 리소스나 그 외의 스킴과 연결해야 하므로 서버의 이름과 URI 스킴이 포함된 완전한 URI가 필요함. 즉, 클라이언트가 프락시를 사용하도록 설정되어 있다면 완전한 URI를 보냄.
- HTTP/1.1은 프락시와 서버 요청 모두에 대해 완전한 URI를 다룰 것을 요구함.

### 6.5.2 가상 호스팅에서 일어나는 같은 문제

- 가상 호스트에서도 스킴/호스트/포트번호 누락 문제가 있으나 호스트와 포트에 대한 정보가 담겨 있는 Host 헤더를 요구함으로서 해결함.
