# 6장 프락시

## 웹 중개자

> 웹 프락시 서버는 클라이언트의 입장에서 트랜잭션을 수행하는 중개인이다.
> <br> 웹 프락시 서버는 웹 서버이기도 하면서 웹 클라이언트이기도 하다.

### 개인 프락시와 공유 프락시

- 개인 프락시: 하나의 클라이언트만을 위한 프락시
- 공유 프락시: 여러 클라이언트가 함께 사용하는 프락시로 사용자가 많을수록 유리하다.

### 프락시 vs 게이트웨이

> 프락시와 게이트웨이의 실질적인 차이점은 모호하다.
> <br>프락시가 이따금 약간의 프로토콜 변환을 하기도 하며 상용 프락시 서버는 SSL 프로토콜, SOCKS 방화벽, FTP 접근, 웹 기반의 애플리케이션 지원을 위해 게이트웨이 기능을 구현하기 때문

- 프락시: 같은 프로토콜을 사용하는 둘 이상의 애플리케이션 연결

```shell
브라우저 <-HTTP-> 웹 프락시 <-HTTP-> 웹 서버
```

- 게이트웨이: 서로 다른 프로토콜을 사용하는 둘 이상을 연결

```shell
브라우저 <-HTTP-> 웹/이메일 게이트웨이 <-HTTP-> 웹 서버
```

## 왜 프락시를 사용하는가?

> - 보안 개선
> - 성능 향상
> - 비용 절약

이 외에도 어린이 필터, 문서 접근 제어자, 보안 방화벽, 웹 캐시, 대리 프락시, 콘텐츠 라우터, 트랜스코더, 익명화 프락시 등 여러가지 기능들을 제공하기도 한다.

## 프락시는 어디에 있는가?

### 프락시 배치 서버

> 사용 용도에 따라 프락시를 어디에든 배치할 수 있다.

- 출구 프락시: 로컬 네트워크와 더 큰 인터넷 사이 오가는 트래픽을 제어하기 위해 프락시를 로컬 네트워크 출구에 놓을 수 있다.
- 입구 프락시: 모든 요청을 종합적으로 처리하기 위해 ISP 접근 지점에 위치하기도 한다.
  - 보통 캐시 프락시를 사용해 많이 찾는 문서들의 사본을 저장한다.
- 대리 프락시: 웹 서버로 향하는 모든 요청을 처리하고 필요할 때만 웹 서버에 자원을 요청한다.
- 네트워크 교환 프락시: 캐시를 이용해 인터넷 교차로의 혼잡을 완화하고 트래픽 흐름을 감시하기 위해 네트워크 사이의 인터넷 피어링 교환 지점에 놓일 수 있다.

### 프락시 계층

> 프락시들은 프락시 계층과 같은 연쇄를 구성할 수 있는데, 프락시 서버들은 부모와 자식의 관계를 맺는다.

서버쪽에 가까운 프락시를 인바운드 프락시(부모)라고 하며 클라이언트에 가까운 프락시를 아웃바운드 프락시(자식)라고 한다.

- 프락시 계층 콘텐츠 라우팅: 계층이 반드시 정적이지는 않고, 상황에 따라 부모 프락시나 원 서버에 라우팅하기도 한다.
- 부하 균형: 부하를 분산하기 위해 부모들의 작업량 수준에 근거하여 부모 프락시를 선택한다.
- 지리적 인접성에 근거한 라우팅: 원 서버의 지역을 담당하는 부모를 선택
- 프로토콜/타입 라우팅: URI에 근거하여 판단하며, 특정 종류의 URI를 갖고 있는 요청의 경우 특별한 프락시 서버로 보내져 특별한 프로토콜로 처리될 수 있다.
- 유료 서비스 가입자를 위한 라우팅: 웹 서비스 운영자가 빠른 서비스를 위해 추가금을 지불한 경우, 그들의 URI는 대형 캐시나 성능 개선을 위한 압축 엔진으로 라우팅을 돌릴 수 있다.

### 어떻게 프락시가 트래픽을 처리하는가

> 클라이언트 트래픽이 프락시로 가도록 하는 방법 4가지

- 클라이언트를 수정한다: 브라우저와 같은 웹 클라이언트에서 프락시를 사용할지 말지 설정하는 것
- 네트워크클 수정한다: 클라이언트 모르게 스위칭 장치와 라우팅 장치를 통해 프락시로 이동시킴(인터셉트 프락시)
- DNS 이름 공간을 수정한다: DNS 이름 테이블을 수동으로 편집하거나 사용할 적절한 프락시나 서버를 계산해주는 특별한 동적 DNS 서버를 이용해서 조정될 수 있다.
- 웹 서버를 수정한다: HTTP 리다이렉션 명령을 클라이언트에게 돌려줌으로서 요청을 프락시로 리다이렉트하도록 설정할 수 있다.

## 클라이언트 프락시 설정

> 브라우저가 프락시를 설정하는 여러가지 방법

- 수동 설정: 프락시를 사용하겠다고 명시적으로 설정
- 브라우저 기본 설정: 브라우저 벤더나 배포자가 브라우저를 소비자에게 전달하기 전에 프락시를 미리 섲렁
- 프락시 자동 설정(PAC): JS 프락시 자동 설정 파일에 대한 URI를 제공
- WPAD 프락시 발견: 자동 설정 파일을 다운 받을 수 있는 `설정 서버`를 자동으로 찾아주는 `웹 프락시 자동발견 프로토콜`을 제공
