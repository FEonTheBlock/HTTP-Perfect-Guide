## 3장 HTTP 메시지

### 3.1 메시지의 흐름

- 인바운드: 클라이언트에서 서버로 향하는 HTTP 트랜잭션 방향
- 아웃바운드: 서버에서 처리가 끝나고 클라이언트로 돌아오는 HTTP 트랜잭션 방향
- 요청과 응답은 모두 다운스트림으로 흐름. 발송자가 업스트림, 수신자가 다운스트림

### 3.2 메시지의 각 부분, 3.3 메서드

- HTTP 메시지는 시작줄, 헤더 블록, 본문으로 구성됨
  - 시작 줄: 무엇을 해야 하는지(요청 메시지), 무슨 일이 일어났는지(응답 메시지)
  - 시작줄과 헤더는 줄 단위로 분리된 아스키 문자열
- 요청 메시지 형식

  > <메서드> <요청 URL> <버전>
  >
  > <헤더>
  >
  > #
  >
  > <엔터티 본문>

- 응답 메시지 형식

  > <버전> <상태 코드> <사유 구절>
  >
  > <헤더>
  >
  > #
  >
  > <엔터티 본문>

- 메서드: 클라이언트 측에서 서버가 리소스에 대해 수행해 주기를 바라는 동작
  - 서버에 따라 구현한 메서드가 다름
  - GET
    - 서버에서 어떤 문서를 가져온다.
    - 서버에게 리소스를 달라고 요청
    - HTTP/1.1에서 이 메서드를 구현할 것을 요구
  - HEAD
    - 서버에서 어떤 문서에 대해 헤더만 가져온다.
    - GET과 같이 행동하지만 응답으로 엔터티 본문 없이 헤더만을 돌려 줌
  - POST
    - 서버가 처리해야 할 데이터를 보낸다.
    - 서버가 요청의 본문을 가지고 요청 URL의 이름대로 새 문서를 만들거나, URL이 존재한다면 본문을 사용해서 교체
  - PUT
    - 서버에 요청 메시지의 본문을 저장한다.
    - 서버에 입력 데이터를 전송하기 위해 설계
  - TRACE
    - 메시지가 프락시를 거쳐 서버에 도달하는 과정을 추적한다.
    - 클라이언트에게 자신의 요청이 서버에 도달했을 때 어떻게 보이게 되는지 알려 줌
    - 주로 진단을 위해 사용
  - OPTIONS
    - 서버가 어떤 메서드를 수행할 수 있는지 확인한다.
    - 웹 서버에게 특정 리소스에 대해 지원되는 메서드의 범위 등을 알려 줌
  - DELETE
    - 서버에서 문서를 제거한다.
    - 클라이언트는 삭제가 수행되는 것을 보장하지 못함
  - 확장 메서드
    - HTTP/1.1 명세에 정의되지 않은 메서드
    - HTTP는 필요에 따라 메서드를 확장할 수 있음
- 요청 URL: 요청 대상이 되는 리소스를 지칭하는 URL
- 버전: 이 메시지에서 사용 중인 HTTP의 버전
- 상태 코드: 요청 중에 무엇이 일어낫는지 설명하는 세 자리 숫자
  - 100-199: 정보
  - 200-299: 성공
    - 200: OK(요청이 성공, 엔터티 본문은 요청된 리소스를 포함함)
  - 300-399: 리다이렉션
  - 400-499: 클라이언트 에러
    - 401: Unauthorized(클라이언트에게 인증을 요구함)
    - 404: Not Found(서버가 요청한 URL을 찾을 수 없음)
  - 500-599: 서버 에러
- 사유 구절: 상태 코드를 사람이 이해할 수 있게 설명하는 짧은 문구
- 헤더: 요청 및 응답 메시지에 더하는 0개 이상의 추가 정보
  - 일반 헤더
    - 클라이언트와 서버 양쪽 모두가 사용하는 헤더
    - 일반 캐시 헤더: HTTP/1.0에서 객체를 로컬 복사본으로부터 캐시할 수 있도록 해 주는 헤더
  - 요청 헤더
    - 서버에게 클라이언트가 받고자 하는 데이터의 타입이 무엇인지와 같은 부가 정보를 제공
    - 누가 요청을 보냈는지에 대한 정보 등을 알려 줌
    - Accept 관련 헤더: 서버에게 자신의 선호와 능력을 알려주는 헤더
    - 조건부 요청 헤더: 클라이언트가 서버에게 요청에 응답하기 전에 먼저 조건이 참인지 확인하게 하는 제약을 포함시키기 위해 사용하는 헤더
    - 요청 보안 헤더: 간단한 인증을 요구하고 응답하게 하기 위한 헤더
    - 프락시 요청 헤더: 프락시의 기능을 돕기 위한 헤더
  - 응답 헤더
    - 클라이언트에게 정보를 제공하기 위한 헤더
    - 협상 헤더: 협상 가능한 리소스에 대한 정보를 운반하는 헤더
    - 응답 보안 헤더: HTTP 인증 요구 및 응답 체계에서 응답 측에 해당하는 헤더
  - 엔터티 헤더
    - 엔터티 본문에 대한 헤더로 요청과 응답 메시지에 모두 나타날 수 있음
    - 일반적으로 메시지의 수신자에게 자신이 다루고 있는 것이 무엇인지 말해 줌
    - 콘텐츠 헤더: 엔터티의 콘텐츠에 대한 구체적인 정보를 제공하는 헤더로 기저 URL, 인코딩, 본문의 길이 등을 알려 줌
    - 엔터티 캐싱 헤더: 리소스에 대해 캐시된 사본이 아직 유효한지에 대한 정보와 캐시된 리소스가 더 이상 유효하지 않게 되는 시점 등을 추정하는 등 엔터티 캐싱에 대한 정보를 제공하는 헤더
  - 확장 헤더: 승인된 HTTP 명세에 추가되지 않은 비표준 헤더
- 엔터티 본문:
  - 헤더나 엔터티 본문이 없더라도 HTTP 헤더의 집합은 항상 빈 줄로 끝나야 함
  - 텍스트, 이진 데이터를 포함하거나 비어있을 수 있음
